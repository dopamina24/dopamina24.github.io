<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElectroChile - Electrolineras en Chile</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h1 class="logo">&#9889; ElectroChile</h1>
            <button id="sidebar-close" class="sidebar-close" aria-label="Cerrar panel">&times;</button>
        </div>

        <div class="sidebar-content">
            <!-- Search -->
            <div class="search-section">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="Buscar ciudad o direcci&oacute;n..." autocomplete="off">
                    <button id="search-btn" class="btn btn-search" aria-label="Buscar">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    </button>
                </div>
                <button id="locate-btn" class="btn btn-locate">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 2v4M12 18v4M2 12h4M18 12h4"/></svg>
                    Usar mi ubicaci&oacute;n
                </button>
            </div>

            <!-- Filters -->
            <div class="filters-section">
                <h3 class="section-title">Filtros</h3>
                <div class="filter-group">
                    <label class="filter-label">Radio de b&uacute;squeda</label>
                    <div class="range-container">
                        <input type="range" id="radius-range" min="5" max="100" value="25" step="5">
                        <span id="radius-value">25 km</span>
                    </div>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Tipo de conector</label>
                    <div class="connector-filters" id="connector-filters">
                        <label class="checkbox-label">
                            <input type="checkbox" value="all" checked> Todos
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="33"> CCS (Tipo 2)
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="2"> CHAdeMO
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="25"> Tipo 2 (Mennekes)
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="1"> Tipo 1 (J1772)
                        </label>
                    </div>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Nivel de carga</label>
                    <div class="level-filters" id="level-filters">
                        <label class="checkbox-label">
                            <input type="checkbox" value="all" checked> Todos
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="3"> DC R&aacute;pido (Nivel 3)
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="2"> AC Nivel 2
                        </label>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div class="results-section">
                <div class="results-header">
                    <h3 class="section-title">Estaciones</h3>
                    <span id="results-count" class="results-count">0 encontradas</span>
                </div>
                <div id="results-list" class="results-list">
                    <div class="empty-state">
                        <p>Busca una ubicaci&oacute;n o usa tu geolocalizaci&oacute;n para encontrar electrolineras cercanas.</p>
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Mobile toggle -->
    <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Abrir panel">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>

    <!-- Map -->
    <div id="map"></div>

    <!-- Loading overlay -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Buscando electrolineras...</p>
    </div>

    <!-- API Key Modal -->
    <div id="api-key-modal" class="modal hidden">
        <div class="modal-content">
            <h2>&#9889; Configurar API Key</h2>
            <p>Para buscar electrolineras necesitas una API key gratuita de <a href="https://openchargemap.org/site/loginprovider/beginlogin" target="_blank" rel="noopener">Open Charge Map</a>.</p>
            <ol>
                <li>Crea una cuenta en Open Charge Map</li>
                <li>Ve a "My Apps" y crea una aplicaci&oacute;n</li>
                <li>Copia tu API key e ingr&eacute;sala aqu&iacute;</li>
            </ol>
            <input type="text" id="api-key-input" placeholder="Ingresa tu API key...">
            <div class="modal-actions">
                <button id="save-api-key" class="btn btn-primary">Guardar</button>
                <button id="skip-api-key" class="btn btn-secondary">Usar sin key (limitado)</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="app.js"></script>
</body>
</html>
